nohup: 忽略输入
2021-06-30 16:54:01.156798: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:54:01.170810: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:54:01.170872: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:54:01.170879: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:54:01.171036: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:54:01.171062: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:54:01.171067: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:54:01.171592: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:54:01.222183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:54:01.237440: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555a17d14360 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:54:01.237537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=1000, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=1, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
2021-06-30 16:54:11.522980: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:54:11.535224: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:54:11.535293: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:54:11.535300: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:54:11.535495: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:54:11.535524: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:54:11.535529: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:54:11.535971: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:54:11.578311: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:54:11.586542: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562fcbeb1180 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:54:11.586649: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=500, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=2, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [7, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
2021-06-30 16:54:19.686211: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:54:19.698768: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:54:19.698833: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:54:19.698841: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:54:19.699166: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:54:19.699194: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:54:19.699200: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:54:19.699619: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:54:19.734143: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:54:19.745866: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55749fb74fb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:54:19.745991: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=333, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=3, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 6, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 6, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 7, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 5, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 3, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 2, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [6, 3, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 9, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [6, 5, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 0, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [6, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 5, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 4, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 9, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 0, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 6, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 4, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 0, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 1, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 2, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [6, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 0, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 5, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [6, 3, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 6, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 3, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 0, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 2, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 5, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 4, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 0, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 4, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [6, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 8, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 5, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 1, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 9, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 1, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 6, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 2, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 8, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
2021-06-30 16:54:28.820237: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:54:28.980318: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:54:28.980460: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:54:28.980496: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:54:28.980880: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:54:28.980965: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:54:28.980985: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:54:28.982054: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:54:29.058210: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:54:29.073241: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d55c836f30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:54:29.073318: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=250, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=4, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 0, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 9, 0, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 2, 4, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 4, 2, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 4, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 6, 4, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 7, 2, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 6, 4, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 7, 4, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 1, 0, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 9, 2, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 8, 5, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 0, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 7, 0, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 1, 6, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 1, 2, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1, 0, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 7, 6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 0, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 3, 9, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 3, 0, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 9, 5, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 0, 1, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 1, 0, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 1, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 2, 4, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 9, 8, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [7, 9, 5, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 4, 7, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 9, 5, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 5, 6, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 7, 3, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 7, 8, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 9, 0, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 5, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 4, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1, 9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 1, 0, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 7, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 4, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 5, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 4, 8, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 2, 9, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 4, 5, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 1, 5, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 9, 8, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 7, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 4, 1, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 3, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 2, 1, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 5, 1, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 3, 5, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 6, 4, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 7, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 8, 4, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1, 2, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 2, 7, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
2021-06-30 16:54:41.306136: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:54:41.319376: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:54:41.319450: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:54:41.319457: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:54:41.319661: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:54:41.319692: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:54:41.319698: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:54:41.320327: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:54:41.362188: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:54:41.373659: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b5bf5667d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:54:41.373761: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=200, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=5, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 0, 6, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 9, 8, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 0, 4, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 5, 6, 7, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 2, 5, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 0, 2, 8, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 7, 1, 6, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 7, 5, 2, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 8, 0, 2, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 7, 6, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 0, 8, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 7, 1, 2, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 0, 7, 3, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 7, 6, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 4, 0, 9, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 4, 7, 3, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 2, 4, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 6, 7, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 4, 5, 0, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 5, 2, 4, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 2, 0, 4, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 3, 9, 5, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2, 1, 7, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 9, 6, 2, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 2, 1, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 6, 7, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 2, 0, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 4, 7, 2, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 8, 9, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [2, 1, 3, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 5, 7, 1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 3, 2, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 4, 7, 1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 5, 2, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1, 0, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 6, 0, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 3, 8, 0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 8, 9, 2, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 6, 8, 5, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 4, 5, 3, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 5, 7, 6, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 6, 7, 4, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 5, 8, 2, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 3, 1, 7, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 3, 6, 9, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 7, 8, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 7, 5, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 3, 1, 5, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 9, 0, 4, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 4, 8, 9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 3, 8, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2, 4, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 1, 7, 6, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 9, 5, 4, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 2, 1, 9, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 9, 0, 2, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 2, 1, 8, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 5, 0, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 9, 7, 8, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
2021-06-30 16:54:49.893358: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:54:49.905852: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:54:49.905968: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:54:49.905977: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:54:49.906238: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:54:49.906288: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:54:49.906302: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:54:49.907239: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:54:49.962147: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:54:49.971499: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555e4d023db0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:54:49.971575: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=166, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=6, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [8, 2, 6, 1, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [8, 1, 2, 0, 6, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [1, 4, 9, 2, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 5, 1, 3, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [9, 0, 7, 2, 6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 7, 1, 5, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [1, 4, 9, 7, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [1, 2, 6, 7, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 9, 1, 7, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [9, 5, 6, 4, 7, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 2, 8, 7, 1, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [8, 5, 2, 1, 9, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [0, 5, 7, 6, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [3, 1, 2, 0, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [5, 6, 7, 4, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 2, 9, 4, 8, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 1, 3, 8, 0, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [3, 4, 8, 2, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 5, 9, 0, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 9, 5, 1, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [0, 7, 9, 4, 8, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [3, 8, 4, 6, 9, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 7, 3, 5, 2, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 6, 4, 9, 3, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 1, 3, 6, 0, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 0, 7, 9, 1, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 0, 3, 4, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 2, 7, 3, 1, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 0, 8, 3, 5, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 7, 5, 8, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [8, 3, 6, 5, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [0, 4, 7, 5, 8, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [9, 3, 2, 1, 8, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 9, 4, 7, 0, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 0, 5, 2, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 1, 3, 8, 7, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 5, 3, 8, 1, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 4, 1, 2, 9, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [0, 5, 7, 3, 1, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 8, 5, 0, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 5, 8, 1, 0, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [5, 2, 6, 9, 7, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 1, 8, 2, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 7, 0, 6, 4, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 7, 6, 9, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [3, 0, 6, 9, 7, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 1, 0, 4, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 7, 4, 5, 1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [9, 0, 6, 5, 2, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [4, 2, 6, 3, 8, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 8, 0, 3, 2, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [1, 2, 3, 6, 9, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [7, 5, 0, 4, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 4, 7, 1, 5, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [2, 3, 1, 0, 8, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [6, 9, 3, 7, 4, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [8, 5, 0, 6, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [8, 0, 1, 6, 5, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
div_idx:  [0, 1, 9, 4, 8, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (996, 700)
2021-06-30 16:55:01.371007: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:55:01.391257: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:55:01.391367: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:55:01.391382: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:55:01.391726: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:55:01.391803: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:55:01.391818: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:55:01.392741: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:55:01.454140: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:55:01.463595: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d9fbe5c740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:55:01.463659: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=142, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=7, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 7, 9, 5, 6, 2, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [4, 6, 9, 7, 8, 5, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [9, 2, 6, 7, 0, 1, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [7, 5, 8, 3, 0, 6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [0, 1, 9, 5, 2, 6, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [5, 3, 9, 1, 7, 0, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [3, 9, 0, 5, 1, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [9, 5, 4, 7, 1, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [2, 4, 0, 9, 3, 8, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [4, 1, 2, 9, 6, 7, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [0, 5, 1, 9, 4, 2, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [1, 2, 8, 7, 3, 4, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [2, 3, 5, 4, 8, 6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [4, 0, 1, 3, 8, 9, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [6, 2, 4, 5, 0, 7, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [4, 6, 9, 2, 1, 8, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [2, 4, 9, 0, 3, 5, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [6, 1, 0, 7, 5, 2, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [7, 9, 8, 4, 1, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [2, 4, 6, 5, 8, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [0, 2, 6, 1, 3, 8, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [3, 0, 7, 9, 5, 4, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 0, 9, 4, 6, 2, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 3, 6, 2, 1, 4, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [5, 6, 4, 8, 0, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [3, 1, 8, 6, 4, 9, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [2, 0, 3, 1, 4, 8, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [0, 8, 1, 7, 6, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [7, 6, 4, 3, 5, 1, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [0, 8, 3, 6, 2, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 9, 1, 6, 5, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [4, 9, 7, 5, 3, 1, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [1, 9, 8, 4, 3, 0, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [4, 5, 6, 9, 2, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [7, 5, 0, 2, 6, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [3, 5, 0, 7, 2, 8, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [6, 0, 9, 8, 3, 1, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [7, 6, 8, 9, 5, 4, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [9, 7, 4, 1, 3, 6, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 1, 6, 9, 0, 5, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [9, 0, 5, 3, 1, 4, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [4, 2, 7, 1, 9, 5, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [7, 9, 4, 3, 6, 0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [3, 7, 5, 9, 6, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 7, 1, 4, 2, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [6, 8, 5, 0, 7, 4, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [3, 4, 5, 7, 9, 8, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 9, 1, 3, 6, 2, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [9, 5, 1, 6, 3, 4, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [8, 0, 5, 6, 9, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [3, 1, 7, 8, 4, 2, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [1, 9, 2, 8, 5, 6, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [2, 0, 1, 3, 4, 6, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [6, 5, 8, 7, 4, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [6, 2, 9, 4, 3, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [0, 6, 9, 8, 2, 5, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [2, 3, 5, 4, 0, 6, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [5, 1, 8, 0, 9, 4, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
div_idx:  [9, 0, 3, 5, 4, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (994, 700)
2021-06-30 16:55:09.922424: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:55:10.081556: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:55:10.081699: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:55:10.081734: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:55:10.082101: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:55:10.082189: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:55:10.082228: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:55:10.083260: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:55:10.130132: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:55:10.139815: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d57fddffa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:55:10.139899: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=125, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=8, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 4, 9, 8, 5, 3, 0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 2, 7, 6, 4, 1, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 1, 3, 6, 9, 4, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 8, 5, 0, 6, 3, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 7, 2, 4, 0, 3, 9, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 8, 2, 3, 6, 7, 1, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 4, 7, 1, 8, 2, 6, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 0, 9, 3, 6, 2, 8, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 1, 5, 2, 6, 3, 0, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 6, 0, 9, 1, 2, 7, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 3, 4, 9, 0, 8, 1, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 4, 0, 5, 2, 9, 8, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 2, 8, 0, 7, 9, 4, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 5, 6, 3, 2, 9, 4, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 4, 2, 5, 6, 3, 1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 7, 5, 4, 9, 2, 1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 8, 4, 2, 0, 3, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 9, 1, 5, 6, 0, 7, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 0, 5, 6, 9, 8, 4, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 2, 0, 7, 5, 6, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 0, 9, 7, 8, 6, 2, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 6, 0, 1, 7, 5, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 8, 7, 9, 0, 1, 6, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 1, 3, 0, 6, 7, 2, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 5, 1, 8, 3, 2, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 4, 1, 6, 9, 5, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1, 4, 9, 8, 7, 0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 6, 4, 5, 9, 1, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 9, 8, 0, 2, 1, 6, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [9, 0, 6, 7, 8, 4, 3, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 7, 9, 0, 3, 8, 2, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 9, 5, 3, 1, 4, 7, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 9, 2, 7, 3, 4, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 4, 1, 5, 8, 7, 0, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 7, 4, 2, 0, 9, 1, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 4, 1, 7, 8, 5, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 6, 7, 4, 8, 2, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 8, 0, 7, 3, 4, 1, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 2, 5, 1, 0, 3, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 1, 0, 6, 8, 4, 3, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 4, 6, 8, 1, 3, 0, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 6, 0, 2, 7, 5, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 4, 7, 9, 3, 5, 8, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 5, 4, 8, 7, 6, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 6, 1, 5, 0, 4, 8, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 8, 0, 1, 5, 6, 9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 1, 9, 6, 5, 8, 0, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 5, 4, 9, 0, 3, 8, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 2, 5, 9, 7, 4, 6, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 3, 2, 7, 4, 9, 0, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 4, 7, 9, 5, 8, 6, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 3, 1, 4, 8, 7, 2, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 3, 2, 6, 1, 8, 5, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 6, 3, 0, 9, 4, 5, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 3, 0, 2, 7, 8, 5, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 0, 5, 4, 2, 1, 9, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 8, 6, 5, 2, 3, 9, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 8, 5, 0, 6, 2, 7, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 3, 7, 4, 6, 5, 8, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
2021-06-30 16:55:20.292448: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:55:20.316191: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:55:20.316294: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:55:20.316312: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:55:20.316572: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:55:20.316621: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:55:20.316653: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:55:20.317399: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:55:20.374155: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:55:20.380666: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56227ed0c860 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:55:20.380743: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=111, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=9, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 6, 0, 3, 7, 5, 1, 8, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 5, 7, 3, 2, 9, 1, 6, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 2, 9, 0, 1, 3, 7, 4, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 7, 3, 9, 6, 5, 2, 4, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 4, 2, 6, 5, 3, 9, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 2, 1, 5, 4, 9, 8, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 0, 3, 7, 4, 1, 5, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 8, 5, 6, 3, 1, 4, 7, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 5, 8, 6, 7, 0, 4, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 7, 2, 1, 6, 0, 4, 8, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 0, 2, 9, 5, 8, 7, 4, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 2, 1, 4, 9, 6, 5, 0, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 8, 7, 1, 6, 2, 3, 9, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 5, 0, 3, 4, 9, 6, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 1, 4, 8, 0, 6, 7, 9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 4, 6, 7, 3, 2, 5, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 1, 7, 2, 8, 5, 6, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 5, 1, 2, 8, 4, 6, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 5, 4, 7, 9, 0, 3, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 0, 8, 5, 3, 4, 1, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 4, 1, 0, 3, 8, 2, 7, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 2, 5, 6, 7, 1, 9, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 3, 6, 5, 1, 0, 2, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 9, 6, 5, 8, 0, 1, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 1, 8, 6, 7, 4, 5, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 2, 6, 7, 4, 1, 5, 9, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 1, 4, 2, 6, 5, 8, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 0, 5, 8, 2, 3, 6, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 7, 9, 8, 6, 2, 4, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [1, 6, 4, 2, 3, 9, 7, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 7, 0, 6, 9, 8, 4, 5, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 0, 6, 2, 1, 9, 4, 3, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 8, 2, 6, 1, 9, 4, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 9, 2, 4, 1, 5, 3, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 3, 5, 6, 8, 9, 0, 1, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 1, 0, 9, 8, 3, 4, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 5, 8, 9, 0, 4, 7, 6, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 8, 2, 0, 3, 9, 6, 7, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [5, 3, 7, 1, 2, 8, 4, 9, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 8, 9, 5, 1, 4, 3, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 9, 6, 4, 8, 0, 5, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 8, 7, 4, 9, 6, 1, 0, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [8, 7, 9, 5, 1, 3, 2, 0, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 6, 3, 9, 2, 0, 8, 7, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 9, 6, 1, 2, 3, 7, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [2, 7, 6, 9, 0, 5, 8, 3, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [6, 2, 8, 5, 3, 4, 7, 1, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 8, 2, 9, 7, 0, 5, 1, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [7, 5, 0, 9, 4, 8, 2, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [1, 0, 8, 7, 5, 4, 6, 2, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 6, 8, 7, 2, 5, 0, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 1, 5, 2, 4, 8, 6, 7, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 1, 8, 6, 0, 2, 4, 5, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [4, 3, 8, 5, 2, 6, 9, 1, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [9, 4, 6, 8, 5, 0, 1, 2, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [6, 8, 9, 0, 4, 1, 5, 7, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 9, 5, 4, 1, 0, 8, 2, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [0, 6, 8, 1, 4, 5, 2, 9, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
div_idx:  [3, 1, 4, 7, 8, 5, 2, 9, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (999, 700)
2021-06-30 16:55:29.502518: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:55:29.542542: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:55:29.542688: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:55:29.542721: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:55:29.543092: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:55:29.543179: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:55:29.543197: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:55:29.543910: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:55:29.582129: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:55:29.592675: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557384f52b80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:55:29.592754: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=100, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet20_cifar10', num_div=10, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet20_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet20_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 32)   4640        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 32)   128         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 32)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 32)   9248        activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 32)   544         activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 32)   128         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 16, 16, 32)   0           conv2d_10[0][0]                  
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 32)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 32)   128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 32)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 32)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   128         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 16, 16, 32)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 32)   9248        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 32)   128         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 32)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 32)   9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 32)   128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 16, 16, 32)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 32)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 8, 8, 64)     18496       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 8, 8, 64)     256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 8, 8, 64)     0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 8, 8, 64)     36928       activation_14[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 8, 8, 64)     2112        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 8, 8, 64)     256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 64)     0           conv2d_17[0][0]                  
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 8, 8, 64)     0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 64)     36928       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 8, 8, 64)     256         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 64)     0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 64)     36928       activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 64)     256         conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 64)     0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 64)     0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 64)     36928       activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 64)     256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 64)     0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 64)     36928       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 64)     256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 8, 8, 64)     0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 64)     0           add_9[0][0]                      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_19[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 274,442
Trainable params: 273,066
Non-trainable params: 1,376
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 4, 9, 8, 5, 3, 0, 2, 6, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 8, 4, 6, 5, 7, 2, 0, 9, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 2, 9, 0, 1, 3, 7, 4, 6, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 2, 4, 8, 3, 5, 6, 9, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 8, 7, 6, 3, 5, 9, 1, 2, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 1, 8, 5, 2, 7, 6, 0, 4, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 1, 7, 4, 8, 2, 5, 9, 6, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2, 0, 3, 6, 4, 5, 7, 1, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 6, 9, 0, 2, 1, 5, 7, 3, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 8, 1, 5, 4, 7, 0, 6, 9, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 3, 4, 8, 9, 1, 0, 6, 2, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 0, 8, 3, 2, 4, 5, 7, 1, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 4, 7, 0, 9, 3, 5, 8, 2, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 9, 6, 3, 2, 4, 5, 0, 1, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 4, 5, 3, 6, 1, 0, 7, 8, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 3, 9, 4, 8, 2, 7, 6, 0, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 6, 2, 3, 1, 0, 5, 7, 4, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 3, 1, 0, 4, 6, 5, 7, 9, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 4, 9, 0, 7, 1, 8, 6, 3, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 4, 2, 6, 1, 9, 5, 7, 3, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 6, 9, 1, 5, 0, 3, 2, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 7, 0, 6, 2, 8, 3, 1, 9, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 2, 7, 3, 6, 0, 9, 8, 1, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 0, 6, 5, 4, 7, 1, 8, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1, 8, 5, 2, 0, 4, 7, 9, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 9, 4, 6, 0, 5, 8, 1, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 5, 6, 4, 9, 8, 7, 1, 3, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 7, 8, 2, 3, 5, 4, 0, 9, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 9, 2, 6, 5, 3, 1, 0, 8, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [4, 7, 3, 9, 8, 0, 1, 5, 2, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 0, 3, 8, 7, 4, 5, 6, 1, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 0, 7, 3, 4, 8, 1, 6, 5, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 2, 7, 3, 6, 1, 0, 4, 8, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 1, 9, 4, 7, 0, 6, 5, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 3, 9, 2, 4, 5, 0, 6, 8, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 0, 2, 6, 7, 1, 3, 5, 4, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 1, 9, 5, 0, 4, 7, 6, 2, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 5, 9, 3, 8, 2, 0, 7, 1, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 3, 8, 2, 9, 0, 7, 4, 1, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 0, 1, 3, 6, 8, 5, 9, 7, 4]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 2, 6, 4, 8, 0, 9, 1, 3, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [4, 9, 1, 3, 7, 2, 0, 8, 5, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 9, 7, 8, 5, 0, 4, 1, 3, 6]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 3, 7, 8, 0, 5, 4, 2, 6, 1]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [7, 5, 2, 0, 3, 6, 1, 4, 8, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 9, 3, 2, 1, 4, 5, 7, 8, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [3, 5, 2, 9, 1, 0, 4, 6, 7, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 5, 6, 1, 9, 4, 7, 3, 8, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 3, 6, 5, 4, 2, 7, 1, 0, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 9, 3, 8, 6, 4, 7, 1, 5, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 7, 0, 3, 2, 4, 5, 6, 1, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [6, 1, 5, 0, 3, 9, 4, 8, 7, 2]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [5, 9, 3, 7, 2, 1, 6, 0, 4, 8]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [1, 4, 2, 8, 9, 3, 7, 0, 6, 5]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 1, 4, 8, 5, 7, 6, 2, 3, 9]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [0, 5, 3, 9, 4, 2, 8, 6, 1, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [9, 8, 5, 4, 1, 3, 7, 6, 2, 0]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [2, 6, 5, 0, 9, 7, 8, 4, 1, 3]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
div_idx:  [8, 5, 3, 0, 9, 6, 2, 1, 4, 7]
test_fitness.shape:  (10000, 700)
size of selected fitness:  (1000, 700)
2021-06-30 16:55:39.870782: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:55:39.892859: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:55:39.892969: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:55:39.892984: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:55:39.893240: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:55:39.893286: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:55:39.893299: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:55:39.894084: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:55:39.950058: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:55:39.956036: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5637d6ab6710 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:55:39.956106: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=1000, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=1, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
2021-06-30 16:55:59.419639: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:55:59.435698: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:55:59.435768: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:55:59.435778: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:55:59.435978: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:55:59.436032: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:55:59.436044: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:55:59.436648: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:55:59.482078: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:55:59.488408: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558257923190 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:55:59.488477: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=500, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=2, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [7, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
2021-06-30 16:56:17.262172: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:56:17.282914: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:56:17.282991: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:56:17.283007: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:56:17.283206: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:56:17.283254: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:56:17.283265: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:56:17.283781: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:56:17.378105: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:56:17.388242: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557997519d00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:56:17.388339: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=333, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=3, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 6, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 6, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 7, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 5, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 3, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 2, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [6, 3, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 9, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [6, 5, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 0, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [6, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 5, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 4, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 9, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 0, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 6, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 4, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 0, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 1, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 2, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [6, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 0, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 5, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [6, 3, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 6, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 3, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 0, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 2, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 5, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 4, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 0, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 4, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [6, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 8, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 5, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 1, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 9, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 1, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 6, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 2, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 8, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
2021-06-30 16:56:35.380653: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:56:35.394848: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:56:35.394929: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:56:35.394936: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:56:35.395135: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:56:35.395166: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:56:35.395172: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:56:35.395765: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:56:35.430125: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:56:35.438897: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5568224c24c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:56:35.438993: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=250, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=4, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 0, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 9, 0, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 2, 4, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 4, 2, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 4, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 6, 4, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 7, 2, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 6, 4, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 7, 4, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 1, 0, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 9, 2, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 8, 5, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 0, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 7, 0, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 1, 6, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 1, 2, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1, 0, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 7, 6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 0, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 3, 9, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 3, 0, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 9, 5, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 0, 1, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 1, 0, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 1, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 2, 4, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 9, 8, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [7, 9, 5, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 4, 7, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 9, 5, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 5, 6, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 7, 3, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 7, 8, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 9, 0, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 5, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 4, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1, 9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 1, 0, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 7, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 4, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 5, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 4, 8, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 2, 9, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 4, 5, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 1, 5, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 9, 8, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 7, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 4, 1, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 3, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 2, 1, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 5, 1, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 3, 5, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 6, 4, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 7, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 8, 4, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1, 2, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 2, 7, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
2021-06-30 16:56:49.142099: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:56:49.164371: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:56:49.164474: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:56:49.164489: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:56:49.164726: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:56:49.164775: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:56:49.164788: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:56:49.165303: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:56:49.206108: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:56:49.216327: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5611283cc130 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:56:49.216395: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=200, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=5, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 0, 6, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 9, 8, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 0, 4, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 5, 6, 7, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 2, 5, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 0, 2, 8, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 7, 1, 6, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 7, 5, 2, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 8, 0, 2, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 7, 6, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 0, 8, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 7, 1, 2, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 0, 7, 3, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 7, 6, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 4, 0, 9, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 4, 7, 3, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 2, 4, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 6, 7, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 4, 5, 0, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 5, 2, 4, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 2, 0, 4, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 3, 9, 5, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2, 1, 7, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 9, 6, 2, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 2, 1, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 6, 7, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 2, 0, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 4, 7, 2, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 8, 9, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [2, 1, 3, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 5, 7, 1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 3, 2, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 4, 7, 1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 5, 2, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1, 0, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 6, 0, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 3, 8, 0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 8, 9, 2, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 6, 8, 5, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 4, 5, 3, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 5, 7, 6, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 6, 7, 4, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 5, 8, 2, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 3, 1, 7, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 3, 6, 9, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 7, 8, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 7, 5, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 3, 1, 5, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 9, 0, 4, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 4, 8, 9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 3, 8, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2, 4, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 1, 7, 6, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 9, 5, 4, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 2, 1, 9, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 9, 0, 2, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 2, 1, 8, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 5, 0, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 9, 7, 8, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
(1000, 1960)
2021-06-30 16:57:03.789042: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:57:03.801701: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:57:03.801764: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:57:03.801771: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:57:03.802012: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:57:03.802046: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:57:03.802052: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:57:03.802638: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:57:03.842279: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:57:03.849992: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d67f8ae900 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:57:03.850060: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=166, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=6, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [8, 2, 6, 1, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [8, 1, 2, 0, 6, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [1, 4, 9, 2, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 5, 1, 3, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [9, 0, 7, 2, 6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 7, 1, 5, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [1, 4, 9, 7, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [1, 2, 6, 7, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 9, 1, 7, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [9, 5, 6, 4, 7, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 2, 8, 7, 1, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [8, 5, 2, 1, 9, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [0, 5, 7, 6, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [3, 1, 2, 0, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [5, 6, 7, 4, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 2, 9, 4, 8, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 1, 3, 8, 0, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [3, 4, 8, 2, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 5, 9, 0, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 9, 5, 1, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [0, 7, 9, 4, 8, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [3, 8, 4, 6, 9, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 7, 3, 5, 2, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 6, 4, 9, 3, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 1, 3, 6, 0, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 0, 7, 9, 1, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 0, 3, 4, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 2, 7, 3, 1, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 0, 8, 3, 5, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 7, 5, 8, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [8, 3, 6, 5, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [0, 4, 7, 5, 8, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [9, 3, 2, 1, 8, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 9, 4, 7, 0, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 0, 5, 2, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 1, 3, 8, 7, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 5, 3, 8, 1, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 4, 1, 2, 9, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [0, 5, 7, 3, 1, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 8, 5, 0, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 5, 8, 1, 0, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [5, 2, 6, 9, 7, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 1, 8, 2, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 7, 0, 6, 4, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 7, 6, 9, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [3, 0, 6, 9, 7, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 1, 0, 4, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 7, 4, 5, 1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [9, 0, 6, 5, 2, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [4, 2, 6, 3, 8, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 8, 0, 3, 2, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [1, 2, 3, 6, 9, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [7, 5, 0, 4, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 4, 7, 1, 5, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [2, 3, 1, 0, 8, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [6, 9, 3, 7, 4, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [8, 5, 0, 6, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
div_idx:  [8, 0, 1, 6, 5, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 (996, 1960)
div_idx:  [0, 1, 9, 4, 8, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (996, 1960)
2021-06-30 16:57:16.168383: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:57:16.191115: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:57:16.191207: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:57:16.191222: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:57:16.191450: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:57:16.191500: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:57:16.191512: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:57:16.192331: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:57:16.242145: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:57:16.251821: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5578feebc050 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:57:16.251910: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=142, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=7, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 7, 9, 5, 6, 2, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [4, 6, 9, 7, 8, 5, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [9, 2, 6, 7, 0, 1, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [7, 5, 8, 3, 0, 6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [0, 1, 9, 5, 2, 6, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [5, 3, 9, 1, 7, 0, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [3, 9, 0, 5, 1, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [9, 5, 4, 7, 1, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [2, 4, 0, 9, 3, 8, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [4, 1, 2, 9, 6, 7, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [0, 5, 1, 9, 4, 2, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [1, 2, 8, 7, 3, 4, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [2, 3, 5, 4, 8, 6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [4, 0, 1, 3, 8, 9, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [6, 2, 4, 5, 0, 7, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [4, 6, 9, 2, 1, 8, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [2, 4, 9, 0, 3, 5, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [6, 1, 0, 7, 5, 2, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [7, 9, 8, 4, 1, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [2, 4, 6, 5, 8, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [0, 2, 6, 1, 3, 8, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [3, 0, 7, 9, 5, 4, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 0, 9, 4, 6, 2, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 3, 6, 2, 1, 4, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [5, 6, 4, 8, 0, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [3, 1, 8, 6, 4, 9, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [2, 0, 3, 1, 4, 8, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [0, 8, 1, 7, 6, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [7, 6, 4, 3, 5, 1, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [0, 8, 3, 6, 2, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 9, 1, 6, 5, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [4, 9, 7, 5, 3, 1, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [1, 9, 8, 4, 3, 0, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [4, 5, 6, 9, 2, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [7, 5, 0, 2, 6, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [3, 5, 0, 7, 2, 8, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [6, 0, 9, 8, 3, 1, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [7, 6, 8, 9, 5, 4, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [9, 7, 4, 1, 3, 6, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 1, 6, 9, 0, 5, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [9, 0, 5, 3, 1, 4, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [4, 2, 7, 1, 9, 5, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [7, 9, 4, 3, 6, 0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [3, 7, 5, 9, 6, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 7, 1, 4, 2, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [6, 8, 5, 0, 7, 4, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [3, 4, 5, 7, 9, 8, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 9, 1, 3, 6, 2, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [9, 5, 1, 6, 3, 4, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [8, 0, 5, 6, 9, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [3, 1, 7, 8, 4, 2, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [1, 9, 2, 8, 5, 6, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [2, 0, 1, 3, 4, 6, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [6, 5, 8, 7, 4, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [6, 2, 9, 4, 3, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [0, 6, 9, 8, 2, 5, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 [2, 3, 5, 4, 0, 6, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [5, 1, 8, 0, 9, 4, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
div_idx:  [9, 0, 3, 5, 4, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (994, 1960)
2021-06-30 16:57:33.886208: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:57:33.901807: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:57:33.901881: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:57:33.901901: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:57:33.902085: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:57:33.902117: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:57:33.902126: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:57:33.902792: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:57:33.942085: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:57:33.949371: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5624f4bfaf20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:57:33.949434: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=125, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=8, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 4, 9, 8, 5, 3, 0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 2, 7, 6, 4, 1, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 1, 3, 6, 9, 4, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 8, 5, 0, 6, 3, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 7, 2, 4, 0, 3, 9, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 8, 2, 3, 6, 7, 1, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 4, 7, 1, 8, 2, 6, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 0, 9, 3, 6, 2, 8, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 1, 5, 2, 6, 3, 0, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 6, 0, 9, 1, 2, 7, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 3, 4, 9, 0, 8, 1, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 4, 0, 5, 2, 9, 8, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 2, 8, 0, 7, 9, 4, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 5, 6, 3, 2, 9, 4, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 4, 2, 5, 6, 3, 1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 7, 5, 4, 9, 2, 1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 8, 4, 2, 0, 3, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 9, 1, 5, 6, 0, 7, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 0, 5, 6, 9, 8, 4, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 2, 0, 7, 5, 6, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 0, 9, 7, 8, 6, 2, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 6, 0, 1, 7, 5, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 8, 7, 9, 0, 1, 6, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 1, 3, 0, 6, 7, 2, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 5, 1, 8, 3, 2, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 4, 1, 6, 9, 5, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1, 4, 9, 8, 7, 0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 6, 4, 5, 9, 1, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 9, 8, 0, 2, 1, 6, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [9, 0, 6, 7, 8, 4, 3, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 7, 9, 0, 3, 8, 2, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 9, 5, 3, 1, 4, 7, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 9, 2, 7, 3, 4, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 4, 1, 5, 8, 7, 0, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 7, 4, 2, 0, 9, 1, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 4, 1, 7, 8, 5, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 6, 7, 4, 8, 2, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 8, 0, 7, 3, 4, 1, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 2, 5, 1, 0, 3, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 1, 0, 6, 8, 4, 3, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 4, 6, 8, 1, 3, 0, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 6, 0, 2, 7, 5, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 4, 7, 9, 3, 5, 8, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 5, 4, 8, 7, 6, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 6, 1, 5, 0, 4, 8, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 8, 0, 1, 5, 6, 9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 1, 9, 6, 5, 8, 0, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 5, 4, 9, 0, 3, 8, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 2, 5, 9, 7, 4, 6, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 3, 2, 7, 4, 9, 0, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 4, 7, 9, 5, 8, 6, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 3, 1, 4, 8, 7, 2, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 3, 2, 6, 1, 8, 5, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 6, 3, 0, 9, 4, 5, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

div_idx:  [1, 3, 0, 2, 7, 8, 5, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 0, 5, 4, 2, 1, 9, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 8, 6, 5, 2, 3, 9, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 8, 5, 0, 6, 2, 7, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 3, 7, 4, 6, 5, 8, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
2021-06-30 16:57:50.127705: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:57:50.150959: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:57:50.151068: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:57:50.151085: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:57:50.151376: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:57:50.151432: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:57:50.151447: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:57:50.152367: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:57:50.182965: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:57:50.192558: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564891175ee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:57:50.192634: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=111, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=9, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 6, 0, 3, 7, 5, 1, 8, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 5, 7, 3, 2, 9, 1, 6, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 2, 9, 0, 1, 3, 7, 4, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 7, 3, 9, 6, 5, 2, 4, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 4, 2, 6, 5, 3, 9, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 2, 1, 5, 4, 9, 8, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 0, 3, 7, 4, 1, 5, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 8, 5, 6, 3, 1, 4, 7, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 5, 8, 6, 7, 0, 4, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 7, 2, 1, 6, 0, 4, 8, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 0, 2, 9, 5, 8, 7, 4, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 2, 1, 4, 9, 6, 5, 0, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 8, 7, 1, 6, 2, 3, 9, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 5, 0, 3, 4, 9, 6, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 1, 4, 8, 0, 6, 7, 9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 4, 6, 7, 3, 2, 5, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 1, 7, 2, 8, 5, 6, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 5, 1, 2, 8, 4, 6, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 5, 4, 7, 9, 0, 3, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 0, 8, 5, 3, 4, 1, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 4, 1, 0, 3, 8, 2, 7, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 2, 5, 6, 7, 1, 9, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 3, 6, 5, 1, 0, 2, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 9, 6, 5, 8, 0, 1, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 1, 8, 6, 7, 4, 5, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 2, 6, 7, 4, 1, 5, 9, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 1, 4, 2, 6, 5, 8, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 0, 5, 8, 2, 3, 6, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 7, 9, 8, 6, 2, 4, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [1, 6, 4, 2, 3, 9, 7, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 7, 0, 6, 9, 8, 4, 5, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 0, 6, 2, 1, 9, 4, 3, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 8, 2, 6, 1, 9, 4, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 9, 2, 4, 1, 5, 3, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 3, 5, 6, 8, 9, 0, 1, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 1, 0, 9, 8, 3, 4, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 5, 8, 9, 0, 4, 7, 6, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 8, 2, 0, 3, 9, 6, 7, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [5, 3, 7, 1, 2, 8, 4, 9, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 8, 9, 5, 1, 4, 3, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 9, 6, 4, 8, 0, 5, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 8, 7, 4, 9, 6, 1, 0, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [8, 7, 9, 5, 1, 3, 2, 0, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 6, 3, 9, 2, 0, 8, 7, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 9, 6, 1, 2, 3, 7, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [2, 7, 6, 9, 0, 5, 8, 3, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [6, 2, 8, 5, 3, 4, 7, 1, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 8, 2, 9, 7, 0, 5, 1, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [7, 5, 0, 9, 4, 8, 2, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [1, 0, 8, 7, 5, 4, 6, 2, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [4, 6, 8, 7, 2, 5, 0, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 1, 5, 2, 4, 8, 6, 7, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 1, 8, 6, 0, 2, 4, 5, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

div_idx:  [4, 3, 8, 5, 2, 6, 9, 1, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [9, 4, 6, 8, 5, 0, 1, 2, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [6, 8, 9, 0, 4, 1, 5, 7, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 9, 5, 4, 1, 0, 8, 2, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [0, 6, 8, 1, 4, 5, 2, 9, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
div_idx:  [3, 1, 4, 7, 8, 5, 2, 9, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (999, 1960)
2021-06-30 16:58:07.357460: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:58:07.370749: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:58:07.370817: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:58:07.370825: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:58:07.370993: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:58:07.371022: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:58:07.371028: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:58:07.371418: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:58:07.406277: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:58:07.413903: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5580ae5c0ff0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:58:07.413984: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=100, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='resnet50_cifar10', num_div=10, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load resnet50_cifar10...
/media/data1/DeepSuite/trained_models/cifar10/resnet50_cifar10.h5
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 32, 32, 3)]  0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 16)   448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 32, 32, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 32, 32, 16)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 32, 16)   2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 32, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 32, 32, 16)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 16)   2320        activation_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 32, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 32, 32, 16)   0           activation_1[0][0]               
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 32, 32, 16)   0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 32, 16)   2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 32, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 32, 16)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 32, 16)   2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 32, 16)   64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 32, 32, 16)   0           activation_3[0][0]               
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 32, 16)   0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 32, 16)   2320        activation_5[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 32, 16)   64          conv2d_6[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 16)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 16)   2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 32, 32, 16)   64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 32, 32, 16)   0           activation_5[0][0]               
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 32, 16)   0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 32, 32, 16)   2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 32, 32, 16)   64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 32, 16)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 32, 32, 16)   2320        activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 32, 32, 16)   64          conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 32, 32, 16)   0           activation_7[0][0]               
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 32, 16)   0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 32, 32, 16)   2320        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 32, 32, 16)   64          conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 32, 16)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 32, 32, 16)   2320        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 32, 32, 16)   64          conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 32, 32, 16)   0           activation_9[0][0]               
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 32, 32, 16)   0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 32, 32, 16)   2320        activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 32, 32, 16)   64          conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 32, 32, 16)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 32, 32, 16)   2320        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 32, 32, 16)   64          conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 32, 32, 16)   0           activation_11[0][0]              
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 32, 32, 16)   0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 32, 32, 16)   2320        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 32, 32, 16)   64          conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 32, 32, 16)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 32, 32, 16)   2320        activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 32, 32, 16)   64          conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 32, 32, 16)   0           activation_13[0][0]              
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 32, 32, 16)   0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 32, 32, 16)   2320        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 32, 32, 16)   64          conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 32, 32, 16)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 32, 32, 16)   2320        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 32, 32, 16)   64          conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 32, 32, 16)   0           activation_15[0][0]              
                                                                 batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 32, 32, 16)   0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 32, 32, 16)   2320        activation_17[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 32, 32, 16)   64          conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 32, 32, 16)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 32, 32, 16)   2320        activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 32, 32, 16)   64          conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 32, 32, 16)   0           activation_17[0][0]              
                                                                 batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 32, 32, 16)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 32)   4640        activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 32)   128         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 32)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 32)   9248        activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 32)   544         activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 32)   128         conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 16, 16, 32)   0           conv2d_22[0][0]                  
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 32)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 32)   9248        activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 32)   128         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 32)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 32)   9248        activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 32)   128         conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 16, 16, 32)   0           activation_21[0][0]              
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 32)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 32)   9248        activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 32)   128         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 32)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 16, 16, 32)   9248        activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 32)   128         conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 16, 16, 32)   0           activation_23[0][0]              
                                                                 batch_normalization_25[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 32)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 32)   9248        activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 16, 16, 32)   128         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 16, 16, 32)   0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 32)   9248        activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 32)   128         conv2d_28[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 16, 16, 32)   0           activation_25[0][0]              
                                                                 batch_normalization_27[0][0]     
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 32)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 16, 16, 32)   9248        activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 32)   128         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 32)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 16, 16, 32)   9248        activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 16, 16, 32)   128         conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 16, 16, 32)   0           activation_27[0][0]              
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 16, 16, 32)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 16, 16, 32)   9248        activation_29[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 16, 16, 32)   128         conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 16, 16, 32)   0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 16, 16, 32)   9248        activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 16, 16, 32)   128         conv2d_32[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 16, 16, 32)   0           activation_29[0][0]              
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 16, 16, 32)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 16, 16, 32)   9248        activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 16, 16, 32)   128         conv2d_33[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 16, 16, 32)   0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 16, 16, 32)   9248        activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 16, 16, 32)   128         conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 16, 16, 32)   0           activation_31[0][0]              
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 16, 16, 32)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 16, 16, 32)   9248        activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 16, 16, 32)   128         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 16, 32)   0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 16, 16, 32)   9248        activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 16, 16, 32)   128         conv2d_36[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 16, 16, 32)   0           activation_33[0][0]              
                                                                 batch_normalization_35[0][0]     
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 16, 16, 32)   0           add_17[0][0]                     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 16, 16, 32)   9248        activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 16, 16, 32)   128         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 16, 16, 32)   0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 16, 16, 32)   9248        activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 16, 16, 32)   128         conv2d_38[0][0]                  
__________________________________________________________________________________________________
add_18 (Add)                    (None, 16, 16, 32)   0           activation_35[0][0]              
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 16, 16, 32)   0           add_18[0][0]                     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 8, 8, 64)     18496       activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 8, 8, 64)     256         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 8, 8, 64)     0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 8, 8, 64)     36928       activation_38[0][0]              
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 8, 8, 64)     2112        activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 8, 8, 64)     256         conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_19 (Add)                    (None, 8, 8, 64)     0           conv2d_41[0][0]                  
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 8, 8, 64)     0           add_19[0][0]                     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 8, 8, 64)     36928       activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 8, 8, 64)     256         conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 8, 8, 64)     0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 8, 8, 64)     36928       activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 8, 8, 64)     256         conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_20 (Add)                    (None, 8, 8, 64)     0           activation_39[0][0]              
                                                                 batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 8, 8, 64)     0           add_20[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 8, 8, 64)     36928       activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 8, 8, 64)     256         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 8, 8, 64)     0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 8, 8, 64)     36928       activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 8, 8, 64)     256         conv2d_45[0][0]                  
__________________________________________________________________________________________________
add_21 (Add)                    (None, 8, 8, 64)     0           activation_41[0][0]              
                                                                 batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 8, 8, 64)     0           add_21[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 8, 8, 64)     36928       activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 8, 8, 64)     256         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 8, 8, 64)     0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 8, 8, 64)     36928       activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 8, 8, 64)     256         conv2d_47[0][0]                  
__________________________________________________________________________________________________
add_22 (Add)                    (None, 8, 8, 64)     0           activation_43[0][0]              
                                                                 batch_normalization_45[0][0]     
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 8, 8, 64)     0           add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 8, 8, 64)     36928       activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 8, 8, 64)     256         conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 8, 8, 64)     0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 8, 8, 64)     36928       activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 8, 8, 64)     256         conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_23 (Add)                    (None, 8, 8, 64)     0           activation_45[0][0]              
                                                                 batch_normalization_47[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 8, 8, 64)     0           add_23[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 8, 8, 64)     36928       activation_47[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 8, 8, 64)     256         conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 8, 8, 64)     0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 8, 8, 64)     36928       activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 8, 8, 64)     256         conv2d_51[0][0]                  
__________________________________________________________________________________________________
add_24 (Add)                    (None, 8, 8, 64)     0           activation_47[0][0]              
                                                                 batch_normalization_49[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 8, 8, 64)     0           add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 8, 8, 64)     36928       activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 8, 8, 64)     256         conv2d_52[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 8, 8, 64)     0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 8, 8, 64)     36928       activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 8, 8, 64)     256         conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_25 (Add)                    (None, 8, 8, 64)     0           activation_49[0][0]              
                                                                 batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 8, 8, 64)     0           add_25[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 8, 8, 64)     36928       activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 8, 8, 64)     256         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 8, 8, 64)     0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 8, 8, 64)     36928       activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 8, 8, 64)     256         conv2d_55[0][0]                  
__________________________________________________________________________________________________
add_26 (Add)                    (None, 8, 8, 64)     0           activation_51[0][0]              
                                                                 batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 8, 8, 64)     0           add_26[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 8, 8, 64)     36928       activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 8, 8, 64)     256         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 8, 8, 64)     0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 8, 8, 64)     36928       activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 8, 8, 64)     256         conv2d_57[0][0]                  
__________________________________________________________________________________________________
add_27 (Add)                    (None, 8, 8, 64)     0           activation_53[0][0]              
                                                                 batch_normalization_55[0][0]     
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 8, 8, 64)     0           add_27[0][0]                     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 64)     0           activation_55[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 10)           650         flatten_1[0][0]                  
==================================================================================================
Total params: 861,770
Trainable params: 857,706
Non-trainable params: 4,064
__________________________________________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 4, 9, 8, 5, 3, 0, 2, 6, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 8, 4, 6, 5, 7, 2, 0, 9, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 2, 9, 0, 1, 3, 7, 4, 6, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 2, 4, 8, 3, 5, 6, 9, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 8, 7, 6, 3, 5, 9, 1, 2, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 1, 8, 5, 2, 7, 6, 0, 4, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 1, 7, 4, 8, 2, 5, 9, 6, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2, 0, 3, 6, 4, 5, 7, 1, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 6, 9, 0, 2, 1, 5, 7, 3, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 8, 1, 5, 4, 7, 0, 6, 9, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 3, 4, 8, 9, 1, 0, 6, 2, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 0, 8, 3, 2, 4, 5, 7, 1, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 4, 7, 0, 9, 3, 5, 8, 2, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 9, 6, 3, 2, 4, 5, 0, 1, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 4, 5, 3, 6, 1, 0, 7, 8, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 3, 9, 4, 8, 2, 7, 6, 0, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 6, 2, 3, 1, 0, 5, 7, 4, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 3, 1, 0, 4, 6, 5, 7, 9, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 4, 9, 0, 7, 1, 8, 6, 3, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 4, 2, 6, 1, 9, 5, 7, 3, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 6, 9, 1, 5, 0, 3, 2, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 7, 0, 6, 2, 8, 3, 1, 9, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 2, 7, 3, 6, 0, 9, 8, 1, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 0, 6, 5, 4, 7, 1, 8, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1, 8, 5, 2, 0, 4, 7, 9, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 9, 4, 6, 0, 5, 8, 1, 7, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 5, 6, 4, 9, 8, 7, 1, 3, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 7, 8, 2, 3, 5, 4, 0, 9, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 9, 2, 6, 5, 3, 1, 0, 8, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [4, 7, 3, 9, 8, 0, 1, 5, 2, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 0, 3, 8, 7, 4, 5, 6, 1, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 0, 7, 3, 4, 8, 1, 6, 5, 2]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 2, 7, 3, 6, 1, 0, 4, 8, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 1, 9, 4, 7, 0, 6, 5, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 3, 9, 2, 4, 5, 0, 6, 8, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 0, 2, 6, 7, 1, 3, 5, 4, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 1, 9, 5, 0, 4, 7, 6, 2, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 5, 9, 3, 8, 2, 0, 7, 1, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 3, 8, 2, 9, 0, 7, 4, 1, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 0, 1, 3, 6, 8, 5, 9, 7, 4]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 2, 6, 4, 8, 0, 9, 1, 3, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [4, 9, 1, 3, 7, 2, 0, 8, 5, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 9, 7, 8, 5, 0, 4, 1, 3, 6]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 3, 7, 8, 0, 5, 4, 2, 6, 1]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [7, 5, 2, 0, 3, 6, 1, 4, 8, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 9, 3, 2, 1, 4, 5, 7, 8, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [3, 5, 2, 9, 1, 0, 4, 6, 7, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 5, 6, 1, 9, 4, 7, 3, 8, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 3, 6, 5, 4, 2, 7, 1, 0, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 9, 3, 8, 6, 4, 7, 1, 5, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 7, 0, 3, 2, 4, 5, 6, 1, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [6, 1, 5, 0, 3, 9, 4, 8, 7, 2]/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [5, 9, 3, 7, 2, 1, 6, 0, 4, 8]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [1, 4, 2, 8, 9, 3, 7, 0, 6, 5]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 1, 4, 8, 5, 7, 6, 2, 3, 9]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [0, 5, 3, 9, 4, 2, 8, 6, 1, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [9, 8, 5, 4, 1, 3, 7, 6, 2, 0]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [2, 6, 5, 0, 9, 7, 8, 4, 1, 3]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
div_idx:  [8, 5, 3, 0, 9, 6, 2, 1, 4, 7]
test_fitness.shape:  (10000, 1960)
size of selected fitness:  (1000, 1960)
2021-06-30 16:58:22.819694: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:58:22.833600: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:58:22.833667: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:58:22.833675: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:58:22.833846: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:58:22.833887: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:58:22.833893: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:58:22.834245: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:58:22.870136: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:58:22.878036: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562e2538e4b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:58:22.878096: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=1000, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=1, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1]
test_fitness.shape:  (10000, 890)
size of selected fitness: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 (1000, 890)
div_idx:  [2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
2021-06-30 16:58:58.524668: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:58:58.546206: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:58:58.546286: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:58:58.546301: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:58:58.546510: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:58:58.546562: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:58:58.546574: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:58:58.546917: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:58:58.586102: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:58:58.595417: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56086d6c4400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:58:58.595476: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=500, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=2, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [7, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 3]
test_fitness.shape: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
2021-06-30 16:59:46.337424: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 16:59:46.348794: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 16:59:46.348845: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 16:59:46.348851: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 16:59:46.348974: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 16:59:46.348993: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 16:59:46.348999: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 16:59:46.349151: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 16:59:46.382131: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 16:59:46.392298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e94825afe0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 16:59:46.392356: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=333, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=3, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 6, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 6, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 7, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 5, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 3, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 2, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [6, 3, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 9, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [6, 5, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 0, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [6, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 5, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 4, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 9, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 0, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 6, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 4, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 0, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 1, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 2, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [6, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 0, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 5, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [6, 3, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 6, 5]
test_fitness.shape:  (10000, 890)/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

size of selected fitness:  (999, 890)
div_idx:  [9, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 3, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 0, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 2, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 5, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 4, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 0, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 4, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [6, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 8, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 5, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 1, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 9, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 1, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 6, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 2, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 8, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
2021-06-30 17:00:09.476083: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 17:00:09.489084: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 17:00:09.489159: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 17:00:09.489166: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 17:00:09.489460: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 17:00:09.489490: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 17:00:09.489495: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 17:00:09.489947: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 17:00:09.530144: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 17:00:09.540957: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56097d2b3710 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 17:00:09.541077: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=250, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=4, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 0, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 9, 0, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 2, 4, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 4, 2, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 4, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 6, 4, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 7, 2, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 6, 4, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 7, 4, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 1, 0, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 9, 2, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 8, 5, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 0, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 7, 0, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 1, 6, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 1, 2, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1, 0, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 7, 6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 0, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 3, 9, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 3, 0, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 9, 5, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 0, 1, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 1, 0, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 1, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 2, 4, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 9, 8, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [7, 9, 5, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 4, 7, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 9, 5, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 5, 6, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 [1, 7, 3, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 7, 8, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 9, 0, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 5, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 4, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1, 9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 1, 0, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 7, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 4, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 5, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 4, 8, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 2, 9, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 4, 5, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 1, 5, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 9, 8, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 7, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 4, 1, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 3, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 2, 1, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 5, 1, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 3, 5, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 6, 4, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 7, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 8, 4, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1, 2, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 2, 7, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
2021-06-30 17:00:29.639382: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 17:00:29.651072: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 17:00:29.651129: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 17:00:29.651136: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 17:00:29.651383: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 17:00:29.651404: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 17:00:29.651409: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 17:00:29.651608: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 17:00:29.694060: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 17:00:29.702582: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eb21cef400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 17:00:29.702648: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=200, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=5, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 0, 6, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 9, 8, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 0, 4, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 5, 6, 7, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 2, 5, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 0, 2, 8, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 7, 1, 6, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 7, 5, 2, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 8, 0, 2, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 7, 6, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 0, 8, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 7, 1, 2, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 0, 7, 3, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 7, 6, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 4, 0, 9, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 4, 7, 3, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 2, 4, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 6, 7, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 4, 5, 0, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 5, 2, 4, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 2, 0, 4, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 3, 9, 5, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2, 1, 7, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 9, 6, 2, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 2, 1, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 6, 7, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 2, 0, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 4, 7, 2, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 8, 9, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [2, 1, 3, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 5, 7, 1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 3, 2, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 [5, 4, 7, 1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 5, 2, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1, 0, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 6, 0, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 3, 8, 0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 8, 9, 2, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 6, 8, 5, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 4, 5, 3, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 5, 7, 6, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 6, 7, 4, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 5, 8, 2, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 3, 1, 7, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 3, 6, 9, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 7, 8, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 7, 5, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 3, 1, 5, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 9, 0, 4, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 4, 8, 9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 3, 8, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2, 4, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 1, 7, 6, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 9, 5, 4, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 2, 1, 9, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 9, 0, 2, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 2, 1, 8, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 5, 0, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 9, 7, 8, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
2021-06-30 17:00:52.263190: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 17:00:52.274499: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 17:00:52.274549: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 17:00:52.274555: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 17:00:52.274671: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 17:00:52.274691: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 17:00:52.274696: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 17:00:52.274872: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 17:00:52.314123: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 17:00:52.321736: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5573dfb6f1f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 17:00:52.321793: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=166, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=6, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [8, 2, 6, 1, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [8, 1, 2, 0, 6, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [1, 4, 9, 2, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 5, 1, 3, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [9, 0, 7, 2, 6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 7, 1, 5, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [1, 4, 9, 7, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [1, 2, 6, 7, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 9, 1, 7, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [9, 5, 6, 4, 7, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 2, 8, 7, 1, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [8, 5, 2, 1, 9, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [0, 5, 7, 6, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [3, 1, 2, 0, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [5, 6, 7, 4, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 2, 9, 4, 8, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 1, 3, 8, 0, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [3, 4, 8, 2, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 5, 9, 0, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 9, 5, 1, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [0, 7, 9, 4, 8, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [3, 8, 4, 6, 9, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 7, 3, 5, 2, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 6, 4, 9, 3, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 1, 3, 6, 0, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 0, 7, 9, 1, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 0, 3, 4, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 2, 7, 3, 1, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 0, 8, 3, 5, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 7, 5, 8, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [8, 3, 6, 5, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [0, 4, 7, 5, 8, 2]
test_fitness.shape: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [9, 3, 2, 1, 8, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 9, 4, 7, 0, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 0, 5, 2, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 1, 3, 8, 7, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 5, 3, 8, 1, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 4, 1, 2, 9, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [0, 5, 7, 3, 1, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 8, 5, 0, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 5, 8, 1, 0, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [5, 2, 6, 9, 7, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 1, 8, 2, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 7, 0, 6, 4, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 7, 6, 9, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [3, 0, 6, 9, 7, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 1, 0, 4, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 7, 4, 5, 1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [9, 0, 6, 5, 2, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [4, 2, 6, 3, 8, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 8, 0, 3, 2, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [1, 2, 3, 6, 9, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [7, 5, 0, 4, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 4, 7, 1, 5, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [2, 3, 1, 0, 8, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [6, 9, 3, 7, 4, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [8, 5, 0, 6, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [8, 0, 1, 6, 5, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
div_idx:  [0, 1, 9, 4, 8, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (996, 890)
2021-06-30 17:01:14.378955: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 17:01:14.390145: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 17:01:14.390201: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 17:01:14.390217: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 17:01:14.390334: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 17:01:14.390355: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 17:01:14.390360: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 17:01:14.390524: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 17:01:14.426125: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 17:01:14.436228: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d6efff11b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 17:01:14.436297: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=142, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=7, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 7, 9, 5, 6, 2, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [4, 6, 9, 7, 8, 5, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [9, 2, 6, 7, 0, 1, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [7, 5, 8, 3, 0, 6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [0, 1, 9, 5, 2, 6, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [5, 3, 9, 1, 7, 0, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [3, 9, 0, 5, 1, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [9, 5, 4, 7, 1, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [2, 4, 0, 9, 3, 8, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [4, 1, 2, 9, 6, 7, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [0, 5, 1, 9, 4, 2, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [1, 2, 8, 7, 3, 4, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [2, 3, 5, 4, 8, 6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [4, 0, 1, 3, 8, 9, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [6, 2, 4, 5, 0, 7, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [4, 6, 9, 2, 1, 8, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [2, 4, 9, 0, 3, 5, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [6, 1, 0, 7, 5, 2, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [7, 9, 8, 4, 1, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [2, 4, 6, 5, 8, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [0, 2, 6, 1, 3, 8, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [3, 0, 7, 9, 5, 4, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 0, 9, 4, 6, 2, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 3, 6, 2, 1, 4, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [5, 6, 4, 8, 0, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [3, 1, 8, 6, 4, 9, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [2, 0, 3, 1, 4, 8, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [0, 8, 1, 7, 6, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [7, 6, 4, 3, 5, 1, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [0, 8, 3, 6, 2, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 9, 1, 6, 5, 3, 2]
test_fitness.shape: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [4, 9, 7, 5, 3, 1, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [1, 9, 8, 4, 3, 0, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [4, 5, 6, 9, 2, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [7, 5, 0, 2, 6, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [3, 5, 0, 7, 2, 8, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [6, 0, 9, 8, 3, 1, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [7, 6, 8, 9, 5, 4, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [9, 7, 4, 1, 3, 6, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 1, 6, 9, 0, 5, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [9, 0, 5, 3, 1, 4, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [4, 2, 7, 1, 9, 5, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [7, 9, 4, 3, 6, 0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [3, 7, 5, 9, 6, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 7, 1, 4, 2, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [6, 8, 5, 0, 7, 4, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [3, 4, 5, 7, 9, 8, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 9, 1, 3, 6, 2, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [9, 5, 1, 6, 3, 4, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [8, 0, 5, 6, 9, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [3, 1, 7, 8, 4, 2, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [1, 9, 2, 8, 5, 6, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [2, 0, 1, 3, 4, 6, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [6, 5, 8, 7, 4, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [6, 2, 9, 4, 3, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [0, 6, 9, 8, 2, 5, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [2, 3, 5, 4, 0, 6, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [5, 1, 8, 0, 9, 4, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
div_idx:  [9, 0, 3, 5, 4, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (994, 890)
2021-06-30 17:01:35.509977: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 17:01:35.521521: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 17:01:35.521571: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 17:01:35.521577: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 17:01:35.521709: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 17:01:35.521730: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 17:01:35.521736: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 17:01:35.521903: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 17:01:35.562137: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 17:01:35.572444: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5557319049a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 17:01:35.572484: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=125, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=8, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 4, 9, 8, 5, 3, 0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 2, 7, 6, 4, 1, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 1, 3, 6, 9, 4, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 8, 5, 0, 6, 3, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 7, 2, 4, 0, 3, 9, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 8, 2, 3, 6, 7, 1, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 4, 7, 1, 8, 2, 6, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 0, 9, 3, 6, 2, 8, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 1, 5, 2, 6, 3, 0, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 6, 0, 9, 1, 2, 7, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 3, 4, 9, 0, 8, 1, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 4, 0, 5, 2, 9, 8, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 2, 8, 0, 7, 9, 4, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 5, 6, 3, 2, 9, 4, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 4, 2, 5, 6, 3, 1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 7, 5, 4, 9, 2, 1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 8, 4, 2, 0, 3, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 9, 1, 5, 6, 0, 7, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 0, 5, 6, 9, 8, 4, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 2, 0, 7, 5, 6, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 0, 9, 7, 8, 6, 2, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 6, 0, 1, 7, 5, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 8, 7, 9, 0, 1, 6, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 1, 3, 0, 6, 7, 2, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 5, 1, 8, 3, 2, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 4, 1, 6, 9, 5, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1, 4, 9, 8, 7, 0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 6, 4, 5, 9, 1, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 9, 8, 0, 2, 1, 6, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [9, 0, 6, 7, 8, 4, 3, 5]/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 7, 9, 0, 3, 8, 2, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 9, 5, 3, 1, 4, 7, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 9, 2, 7, 3, 4, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 4, 1, 5, 8, 7, 0, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 7, 4, 2, 0, 9, 1, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 4, 1, 7, 8, 5, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 6, 7, 4, 8, 2, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 8, 0, 7, 3, 4, 1, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 2, 5, 1, 0, 3, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 1, 0, 6, 8, 4, 3, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 4, 6, 8, 1, 3, 0, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 6, 0, 2, 7, 5, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 4, 7, 9, 3, 5, 8, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 5, 4, 8, 7, 6, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 6, 1, 5, 0, 4, 8, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 8, 0, 1, 5, 6, 9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 1, 9, 6, 5, 8, 0, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 5, 4, 9, 0, 3, 8, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 2, 5, 9, 7, 4, 6, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 3, 2, 7, 4, 9, 0, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 4, 7, 9, 5, 8, 6, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 3, 1, 4, 8, 7, 2, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 3, 2, 6, 1, 8, 5, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 6, 3, 0, 9, 4, 5, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 3, 0, 2, 7, 8, 5, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 0, 5, 4, 2, 1, 9, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 8, 6, 5, 2, 3, 9, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 8, 5, 0, 6, 2, 7, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 3, 7, 4, 6, 5, 8, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
2021-06-30 17:01:57.485203: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 17:01:57.497632: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 17:01:57.497692: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 17:01:57.497698: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 17:01:57.497846: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 17:01:57.497871: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 17:01:57.497877: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 17:01:57.498235: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 17:01:57.546125: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 17:01:57.557681: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5558298da430 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 17:01:57.557757: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=111, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=9, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 6, 0, 3, 7, 5, 1, 8, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 5, 7, 3, 2, 9, 1, 6, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 2, 9, 0, 1, 3, 7, 4, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 7, 3, 9, 6, 5, 2, 4, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 4, 2, 6, 5, 3, 9, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 2, 1, 5, 4, 9, 8, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 0, 3, 7, 4, 1, 5, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 8, 5, 6, 3, 1, 4, 7, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 5, 8, 6, 7, 0, 4, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 7, 2, 1, 6, 0, 4, 8, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 0, 2, 9, 5, 8, 7, 4, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 2, 1, 4, 9, 6, 5, 0, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 8, 7, 1, 6, 2, 3, 9, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 5, 0, 3, 4, 9, 6, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 1, 4, 8, 0, 6, 7, 9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 4, 6, 7, 3, 2, 5, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 1, 7, 2, 8, 5, 6, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 5, 1, 2, 8, 4, 6, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 5, 4, 7, 9, 0, 3, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 0, 8, 5, 3, 4, 1, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 4, 1, 0, 3, 8, 2, 7, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 2, 5, 6, 7, 1, 9, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 3, 6, 5, 1, 0, 2, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 9, 6, 5, 8, 0, 1, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 1, 8, 6, 7, 4, 5, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 2, 6, 7, 4, 1, 5, 9, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 1, 4, 2, 6, 5, 8, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 0, 5, 8, 2, 3, 6, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 7, 9, 8, 6, 2, 4, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]: /home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step
 1000
key:  2  D[d]:  1000
div_idx:  [1, 6, 4, 2, 3, 9, 7, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 7, 0, 6, 9, 8, 4, 5, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 0, 6, 2, 1, 9, 4, 3, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 8, 2, 6, 1, 9, 4, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 9, 2, 4, 1, 5, 3, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 3, 5, 6, 8, 9, 0, 1, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 1, 0, 9, 8, 3, 4, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 5, 8, 9, 0, 4, 7, 6, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 8, 2, 0, 3, 9, 6, 7, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [5, 3, 7, 1, 2, 8, 4, 9, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 8, 9, 5, 1, 4, 3, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 9, 6, 4, 8, 0, 5, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 8, 7, 4, 9, 6, 1, 0, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [8, 7, 9, 5, 1, 3, 2, 0, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 6, 3, 9, 2, 0, 8, 7, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 9, 6, 1, 2, 3, 7, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [2, 7, 6, 9, 0, 5, 8, 3, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [6, 2, 8, 5, 3, 4, 7, 1, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 8, 2, 9, 7, 0, 5, 1, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [7, 5, 0, 9, 4, 8, 2, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [1, 0, 8, 7, 5, 4, 6, 2, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 6, 8, 7, 2, 5, 0, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 1, 5, 2, 4, 8, 6, 7, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 1, 8, 6, 0, 2, 4, 5, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [4, 3, 8, 5, 2, 6, 9, 1, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [9, 4, 6, 8, 5, 0, 1, 2, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [6, 8, 9, 0, 4, 1, 5, 7, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 9, 5, 4, 1, 0, 8, 2, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [0, 6, 8, 1, 4, 5, 2, 9, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
div_idx:  [3, 1, 4, 7, 8, 5, 2, 9, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (999, 890)
2021-06-30 17:02:18.146778: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-30 17:02:18.294877: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-06-30 17:02:18.294937: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: dell-PowerEdge-R940xa
2021-06-30 17:02:18.294947: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: dell-PowerEdge-R940xa
2021-06-30 17:02:18.295099: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 440.44.0
2021-06-30 17:02:18.295129: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 440.44.0
2021-06-30 17:02:18.295137: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 440.44.0
2021-06-30 17:02:18.295662: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2021-06-30 17:02:18.350429: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2600000000 Hz
2021-06-30 17:02:18.366882: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c8a1ded7b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 17:02:18.366977: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Namespace(batch_size=1024, dataset='cifar10', each_div=100, idc_layer='all', idc_n=6, iterations=30, k_kmnc=10, k_nc=0.75, k_tknc=1, model='MobileNet', num_div=10, ood_dataset='SUN', path='/media/data1/DeepSuite/', pool_iter=1000, pool_type='test', sa_layer=-1, sa_n=1000, save_path='/media/data1/DeepSuite', wrong_rate=0.1)
load MobileNet...
/media/data1/DeepSuite/trained_models/cifar10/MobileNet.h5
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, None, None, 3)]   0         
_________________________________________________________________
conv1_pad (ZeroPadding2D)    (None, None, None, 3)     0         
_________________________________________________________________
conv1 (Conv2D)               (None, None, None, 32)    864       
_________________________________________________________________
conv1_bn (BatchNormalization (None, None, None, 32)    128       
_________________________________________________________________
conv1_relu (ReLU)            (None, None, None, 32)    0         
_________________________________________________________________
conv_dw_1 (DepthwiseConv2D)  (None, None, None, 32)    288       
_________________________________________________________________
conv_dw_1_bn (BatchNormaliza (None, None, None, 32)    128       
_________________________________________________________________
conv_dw_1_relu (ReLU)        (None, None, None, 32)    0         
_________________________________________________________________
conv_pw_1 (Conv2D)           (None, None, None, 64)    2048      
_________________________________________________________________
conv_pw_1_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_pw_1_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pad_2 (ZeroPadding2D)   (None, None, None, 64)    0         
_________________________________________________________________
conv_dw_2 (DepthwiseConv2D)  (None, None, None, 64)    576       
_________________________________________________________________
conv_dw_2_bn (BatchNormaliza (None, None, None, 64)    256       
_________________________________________________________________
conv_dw_2_relu (ReLU)        (None, None, None, 64)    0         
_________________________________________________________________
conv_pw_2 (Conv2D)           (None, None, None, 128)   8192      
_________________________________________________________________
conv_pw_2_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_2_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_3 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_3 (Conv2D)           (None, None, None, 128)   16384     
_________________________________________________________________
conv_pw_3_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_pw_3_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pad_4 (ZeroPadding2D)   (None, None, None, 128)   0         
_________________________________________________________________
conv_dw_4 (DepthwiseConv2D)  (None, None, None, 128)   1152      
_________________________________________________________________
conv_dw_4_bn (BatchNormaliza (None, None, None, 128)   512       
_________________________________________________________________
conv_dw_4_relu (ReLU)        (None, None, None, 128)   0         
_________________________________________________________________
conv_pw_4 (Conv2D)           (None, None, None, 256)   32768     
_________________________________________________________________
conv_pw_4_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_4_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_5 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_5 (Conv2D)           (None, None, None, 256)   65536     
_________________________________________________________________
conv_pw_5_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_pw_5_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pad_6 (ZeroPadding2D)   (None, None, None, 256)   0         
_________________________________________________________________
conv_dw_6 (DepthwiseConv2D)  (None, None, None, 256)   2304      
_________________________________________________________________
conv_dw_6_bn (BatchNormaliza (None, None, None, 256)   1024      
_________________________________________________________________
conv_dw_6_relu (ReLU)        (None, None, None, 256)   0         
_________________________________________________________________
conv_pw_6 (Conv2D)           (None, None, None, 512)   131072    
_________________________________________________________________
conv_pw_6_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_6_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_7 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_7 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_7_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_7_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_8 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_8 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_8_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_8_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_9 (DepthwiseConv2D)  (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_9 (Conv2D)           (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_9_bn (BatchNormaliza (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_9_relu (ReLU)        (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_10 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_10 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_10_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_10_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_11 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_11 (Conv2D)          (None, None, None, 512)   262144    
_________________________________________________________________
conv_pw_11_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_pw_11_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pad_12 (ZeroPadding2D)  (None, None, None, 512)   0         
_________________________________________________________________
conv_dw_12 (DepthwiseConv2D) (None, None, None, 512)   4608      
_________________________________________________________________
conv_dw_12_bn (BatchNormaliz (None, None, None, 512)   2048      
_________________________________________________________________
conv_dw_12_relu (ReLU)       (None, None, None, 512)   0         
_________________________________________________________________
conv_pw_12 (Conv2D)          (None, None, None, 1024)  524288    
_________________________________________________________________
conv_pw_12_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_12_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_dw_13 (DepthwiseConv2D) (None, None, None, 1024)  9216      
_________________________________________________________________
conv_dw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_dw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
conv_pw_13 (Conv2D)          (None, None, None, 1024)  1048576   
_________________________________________________________________
conv_pw_13_bn (BatchNormaliz (None, None, None, 1024)  4096      
_________________________________________________________________
conv_pw_13_relu (ReLU)       (None, None, None, 1024)  0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 1024)              0         
_________________________________________________________________
dense (Dense)                (None, 64)                65600     
_________________________________________________________________
dense_1 (Dense)              (None, 10)                650       
=================================================================
Total params: 3,295,114
Trainable params: 3,273,226
Non-trainable params: 21,888
_________________________________________________________________
None
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000
key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [3, 1, 8, 5, 6, 0, 2, 9, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 4, 9, 8, 5, 3, 0, 2, 6, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 8, 4, 6, 5, 7, 2, 0, 9, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 2, 9, 0, 1, 3, 7, 4, 6, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 2, 4, 8, 3, 5, 6, 9, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 8, 7, 6, 3, 5, 9, 1, 2, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 1, 8, 5, 2, 7, 6, 0, 4, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 1, 7, 4, 8, 2, 5, 9, 6, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2, 0, 3, 6, 4, 5, 7, 1, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 6, 9, 0, 2, 1, 5, 7, 3, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 8, 1, 5, 4, 7, 0, 6, 9, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 3, 4, 8, 9, 1, 0, 6, 2, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 0, 8, 3, 2, 4, 5, 7, 1, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 4, 7, 0, 9, 3, 5, 8, 2, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 9, 6, 3, 2, 4, 5, 0, 1, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 4, 5, 3, 6, 1, 0, 7, 8, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 3, 9, 4, 8, 2, 7, 6, 0, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 6, 2, 3, 1, 0, 5, 7, 4, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 3, 1, 0, 4, 6, 5, 7, 9, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 4, 9, 0, 7, 1, 8, 6, 3, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 4, 2, 6, 1, 9, 5, 7, 3, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 6, 9, 1, 5, 0, 3, 2, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 7, 0, 6, 2, 8, 3, 1, 9, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 2, 7, 3, 6, 0, 9, 8, 1, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 0, 6, 5, 4, 7, 1, 8, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1, 8, 5, 2, 0, 4, 7, 9, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 9, 4, 6, 0, 5, 8, 1, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 5, 6, 4, 9, 8, 7, 1, 3, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 7, 8, 2, 3, 5, 4, 0, 9, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 9, 2, 6, 5, 3, 1, 0, 8, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
<class 'numpy.ndarray'>
10000
key:  3  D[d]:  1000
key:  8  D[d]:  1000
key:  0  D[d]:  1000/home/zhiyu/anaconda3/envs/GPU/lib/python3.6/site-packages/numpy/core/function_base.py:144: RuntimeWarning: overflow encountered in multiply
  y *= step

key:  6  D[d]:  1000
key:  1  D[d]:  1000
key:  9  D[d]:  1000
key:  5  D[d]:  1000
key:  7  D[d]:  1000
key:  4  D[d]:  1000
key:  2  D[d]:  1000
div_idx:  [4, 7, 3, 9, 8, 0, 1, 5, 2, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 0, 3, 8, 7, 4, 5, 6, 1, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 0, 7, 3, 4, 8, 1, 6, 5, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 2, 7, 3, 6, 1, 0, 4, 8, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 1, 9, 4, 7, 0, 6, 5, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 3, 9, 2, 4, 5, 0, 6, 8, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 0, 2, 6, 7, 1, 3, 5, 4, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 1, 9, 5, 0, 4, 7, 6, 2, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 5, 9, 3, 8, 2, 0, 7, 1, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 3, 8, 2, 9, 0, 7, 4, 1, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 0, 1, 3, 6, 8, 5, 9, 7, 4]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 2, 6, 4, 8, 0, 9, 1, 3, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [4, 9, 1, 3, 7, 2, 0, 8, 5, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 9, 7, 8, 5, 0, 4, 1, 3, 6]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 3, 7, 8, 0, 5, 4, 2, 6, 1]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [7, 5, 2, 0, 3, 6, 1, 4, 8, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 9, 3, 2, 1, 4, 5, 7, 8, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [3, 5, 2, 9, 1, 0, 4, 6, 7, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 5, 6, 1, 9, 4, 7, 3, 8, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 3, 6, 5, 4, 2, 7, 1, 0, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 9, 3, 8, 6, 4, 7, 1, 5, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 7, 0, 3, 2, 4, 5, 6, 1, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [6, 1, 5, 0, 3, 9, 4, 8, 7, 2]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [5, 9, 3, 7, 2, 1, 6, 0, 4, 8]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [1, 4, 2, 8, 9, 3, 7, 0, 6, 5]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 1, 4, 8, 5, 7, 6, 2, 3, 9]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [0, 5, 3, 9, 4, 2, 8, 6, 1, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [9, 8, 5, 4, 1, 3, 7, 6, 2, 0]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [2, 6, 5, 0, 9, 7, 8, 4, 1, 3]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
div_idx:  [8, 5, 3, 0, 9, 6, 2, 1, 4, 7]
test_fitness.shape:  (10000, 890)
size of selected fitness:  (1000, 890)
